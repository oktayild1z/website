<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pınar Yıldız | Çayyolu Ankara</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Ödüller 3x3 grid */
    .awards-grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:20px;
      margin-top:20px
    }
    .awards-grid img{
      width:100%;
      height:100%;
      max-height:520px;
      object-fit:cover;
      border-radius:16px
    }
    /* Hero görsel fallback görünürlüğü */
    .hero-banner .overlay-fallback{display:none}
    .hero-banner img[hidden]+.overlay-fallback{display:grid}
    /* Kart: resim üstte / bilgi altta */
    .card.p.hasimg{display:flex;flex-direction:column;padding:0}
    .card.p.hasimg img{width:100%;height:220px;object-fit:cover;border-top-left-radius:16px;border-top-right-radius:16px}
    .card.p.hasimg .pb{padding:16px}
    /* WhatsApp sabit buton */
    .wa-fab{
      position:fixed;right:18px;bottom:18px;z-index:999;
      width:56px;height:56px;border-radius:50%;
      background:#25D366;display:flex;align-items:center;justify-content:center;
      box-shadow:0 8px 30px rgba(0,0,0,.25)
    }
    .wa-fab img{width:28px;height:28px;display:block}
    /* Küçük ekranlarda ödüller 2 sütun */
    @media (max-width:900px){ .awards-grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:600px){ .awards-grid{grid-template-columns:1fr} }
  </style>
</head>
<body>

  <!-- Üst çubuk: saat & kurlar -->
  <div class="topbar">
    <div class="dt"><span id="clock">--:--</span> <span id="date">--.--.----</span></div>
    <div id="rates">Kurlar yükleniyor…</div>
  </div>

  <!-- Navigasyon -->
  <header class="nav">
    <div class="brand">
      <div class="dot">PY</div>
      <div class="txt"><b>Pınar Yıldız</b><span>Çayyolu • Ankara</span></div>
    </div>
    <nav>
      <a href="#portfoy">Portföy</a>
      <a href="#hakkinda">Hakkımda</a>
      <a href="#awards">Ödüller</a>
      <a href="#yorumlar">Yorumlar</a>
      <a class="btn" href="#iletisim">İletişim</a>
    </nav>
  </header>

  <!-- Hero banner (atakule manzarası) -->
  <section class="hero-banner">
    <img id="hero-img" src="assets/banner.jpg" alt="Ankara — Atakule"
         onerror="this.hidden=true" />
    <div class="overlay-fallback overlay">
      <div class="headline">Çayyolu’nun <b>Ödüllü</b> Danışmanı</div>
      <div class="subhead"><em>Güzel hayaller, doğru adımlarla gerçeğe dönüşür.</em></div>
    </div>
    <div class="overlay">
      <div class="headline">Çayyolu’nun <b>Ödüllü</b> Danışmanı</div>
      <div class="subhead"><em>Güzel hayaller, doğru adımlarla gerçeğe dönüşür.</em></div>
    </div>
  </section>

  <!-- Hakkımda -->
  <section id="hakkinda" class="intro section">
    <div class="intro-grid">
      <div class="intro-photo"><img src="assets/award.jpg" alt="Ödül" /></div>
      <div class="intro-copy">
        <h1><span class="muted">Gayrimenkul Profesyoneli</span><br /><strong>Pınar YILDIZ</strong></h1>
        <ul class="bullets">
          <li>📍 RE/MAX Su 2024 Ciro & Portföy Birincisi</li>
          <li>🏆 Müşteri Memnuniyeti Ödülü Sahibi</li>
          <li>⏱ 1 günde kiralama • 48 saatte satış</li>
          <li>📊 3 yıllık tecrübe; Çayyolu bölge uzmanı</li>
          <li>🎓 Maliye mezunu</li>
        </ul>
        <p class="vision">“Evleri değil; insanların hayatına dokunan hikâyeleri satıyorum.”</p>
        <div class="socials">
          <a target="_blank" href="https://www.instagram.com/remaxsupinar">📸 Instagram</a>
          <a target="_blank" href="https://www.linkedin.com/in/p%C4%B1nar-y%C4%B1ld%C4%B1z-4ab33a333">in LinkedIn</a>
          <a target="_blank" href="https://wa.me/905387026443">💬 WhatsApp</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Portföy -->
  <section id="portfoy" class="section">
    <h2>Portföy</h2>

    <div class="filters">
      <input id="q" placeholder="Arama: başlık, semt…" />
      <select id="f_status">
        <option value="">Durum</option>
        <option>Satılık</option>
        <option>Kiralık</option>
      </select>
      <select id="f_rooms">
        <option value="">Oda</option>
        <option>1+1</option><option>2+1</option><option>3+1</option>
        <option>4+1</option><option>5+2</option>
      </select>
      <select id="f_sort">
        <option value="">Sırala</option>
        <option value="price_asc">Fiyat (Artan)</option>
        <option value="price_desc">Fiyat (Azalan)</option>
        <option value="m2_desc">m² (Büyükten)</option>
        <option value="m2_asc">m² (Küçükten)</option>
      </select>
    </div>

    <div id="cards" class="grid three"></div>
    <p id="empty" class="muted" style="display:none">Kriterlere uyan portföy bulunamadı.</p>
    <p id="csvErr" class="err" style="display:none"></p>
  </section>

  <!-- Ödüller (3×3) -->
  <section id="awards" class="section">
    <h2>Ödüller</h2>
    <div class="awards-grid">
      <img src="assets/award1.jpeg" alt="Ödül 1" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award2.jpeg" alt="Ödül 2" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award3.jpeg" alt="Ödül 3" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award4.jpeg" alt="Ödül 4" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award5.jpeg" alt="Ödül 5" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award6.jpeg" alt="Ödül 6" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award7.jpeg" alt="Ödül 7" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award8.jpeg" alt="Ödül 8" onerror="this.src='assets/no-image.jpg'">
      <img src="assets/award9.jpeg" alt="Ödül 9" onerror="this.src='assets/no-image.jpg'">
    </div>
  </section>

  <!-- Yorumlar -->
  <section id="yorumlar" class="section">
    <h2>Müşteri Yorumları</h2>
    <div id="twrap" class="twrap"></div>
  </section>

  <!-- İletişim -->
  <section id="iletisim" class="section">
    <h2>İletişim</h2>
    <div class="grid two">
      <div>
        <ul class="contact">
          <li>📍 Dodurga, Çınarcık Sk Ankarakent Sit D:2/1A, 06810 Çankaya/Ankara</li>
          <li>☎️ (0312) 236 83 83</li>
          <li>📱 <a href="tel:+905387026443">0538 702 64 43</a></li>
          <li>📧 <a href="mailto:pinary@remax-su-ank.com">pinary@remax-su-ank.com</a></li>
        </ul>
      </div>
      <iframe class="map" loading="lazy"
        src="https://www.google.com/maps?q=Dodurga,+Çınarcık+Sk+Ankarakent+Sit+D:2/1A,+06810+Çankaya/Ankara&output=embed"></iframe>
    </div>
  </section>

  <footer class="footer">© 2025 Pınar Yıldız • Çayyolu / Ankara</footer>

  <!-- WhatsApp sabit buton -->
  <a class="wa-fab" aria-label="WhatsApp" target="_blank"
     href="https://wa.me/905387026443?text=Merhaba%20P%C4%B1nar%20Han%C4%B1m,%20portf%C3%B6y%20hakk%C4%B1nda%20bilgi%20almak%20istiyorum.">
    <img alt="WhatsApp" src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" />
  </a>

<script>
/* ========== SAAT ========== */
function pad(n){return n<10?'0'+n:n}
function tick(){
  const d=new Date();
  document.getElementById('clock').textContent =
    pad(d.getHours())+':'+pad(d.getMinutes());
  document.getElementById('date').textContent =
    pad(d.getDate())+'.'+pad(d.getMonth()+1)+'.'+d.getFullYear();
}
setInterval(tick,1000); tick();

/* ========== KURLAR (3 kaynaktan dener) ========== */
async function loadRates(){
  const el=document.getElementById('rates');
  async function tryOne(url, pick){
    try{
      const r=await fetch(url,{cache:'no-store'});
      if(!r.ok) throw 0;
      const j=await r.json();
      const o=pick(j);
      if(o){
        el.textContent=`USD ₺ ${o.usd} • EUR ₺ ${o.eur} • GBP ₺ ${o.gbp}`;
        return true;
      }
    }catch(_){}
    return false;
  }
  if(await tryOne('https://api.exchangerate.host/latest?base=TRY&symbols=USD,EUR,GBP',
    j=>j&&j.rates?({usd:(1/j.rates.USD).toFixed(2),eur:(1/j.rates.EUR).toFixed(2),gbp:(1/j.rates.GBP).toFixed(2)}):null)) return;
  if(await tryOne('https://open.er-api.com/v6/latest/TRY',
    j=>j&&j.rates?({usd:(1/j.rates.USD).toFixed(2),eur:(1/j.rates.EUR).toFixed(2),gbp:(1/j.rates.GBP).toFixed(2)}):null)) return;
  if(await tryOne('https://api.frankfurter.app/latest?from=TRY&to=USD,EUR,GBP',
    j=>j&&j.rates?({usd:(1/j.rates.USD).toFixed(2),eur:(1/j.rates.EUR).toFixed(2),gbp:(1/j.rates.GBP).toFixed(2)}):null)) return;
  el.textContent='Kurlar yüklenemedi';
}
loadRates(); setInterval(loadRates, 300000);

/* ========== YARDIMCI: string->number (fiyat, m2) ========== */
function toNumber(v){
  if(!v) return 0;
  const s=String(v).replace(/[^\d.,]/g,'').replace(/\./g,'').replace(',', '.');
  const n=parseFloat(s);
  return isNaN(n)?0:n;
}

/* ========== GÖRSEL ========== */
function imgOf(it){
  const u=(it.image_url||'').trim();
  return (u && /^https?:\/\//i.test(u)) ? u : 'assets/no-image.jpg';
}

/* ========== KART HTML ========== */
function card(x){
  const img = imgOf(x);
  const href = (x.link && /^https?:\/\//i.test(x.link)) ? x.link : '#';
  return `
  <a class="card p hasimg" target="_blank" rel="noopener" href="${href}">
    <img src="${img}" alt="${(x.title||'').replace(/"/g,'&quot;')}"
         onerror="this.onerror=null;this.src='assets/no-image.jpg'">
    <div class="pb">
      <h3>${x.title||''}</h3>
      <div class="meta">${x.district||''} • ${x.rooms||''} • ${x.m2||''} m²</div>
      <div class="price">${x.price||''}</div>
      <div class="small muted">Detaya gitmek için karta tıklayın • WhatsApp</div>
    </div>
  </a>`;
}

/* ========== FİLTRE + SIRALAMA ========== */
function sortData(arr, key){
  const a=[...arr];
  switch(key){
    case 'price_asc':  return a.sort((x,y)=>toNumber(x.price)-toNumber(y.price));
    case 'price_desc': return a.sort((x,y)=>toNumber(y.price)-toNumber(x.price));
    case 'm2_asc':     return a.sort((x,y)=>toNumber(x.m2)-toNumber(y.m2));
    case 'm2_desc':    return a.sort((x,y)=>toNumber(y.m2)-toNumber(x.m2));
    default: return a;
  }
}

function render(data){
  const q = document.getElementById('q').value.toLowerCase();
  const st = document.getElementById('f_status').value;
  const r  = document.getElementById('f_rooms').value;
  const srt= document.getElementById('f_sort').value;

  let items = data.filter(x =>
    (!q || String(x.title||'').toLowerCase().includes(q) ||
           String(x.district||'').toLowerCase().includes(q))
    && (!st || x.status===st)
    && (!r || x.rooms===r)
  );
  items = sortData(items, srt);

  document.getElementById('cards').innerHTML = items.map(card).join('');
  document.getElementById('empty').style.display = items.length ? 'none' : 'block';
}

/* ========== PORTFÖYÜ ÇEK ========== */
async function loadAndRender(){
  const e=document.getElementById('csvErr'); e.style.display='none';
  try{
    const res = await fetch('/.netlify/functions/portfolio',{cache:'no-store'});
    if(!res.ok) throw new Error('HTTP '+res.status);
    const data = await res.json();
    window._DATA = Array.isArray(data) ? data : [];
    render(window._DATA);
  }catch(err){
    e.textContent='Portföy yüklenemedi: '+err.message+' — Function/JSON yanıtını kontrol edin.';
    e.style.display='block';
  }
}
['q','f_status','f_rooms','f_sort'].forEach(id =>
  document.getElementById(id).addEventListener('input',()=>render(window._DATA||[]))
);
loadAndRender(); setInterval(loadAndRender, 120000);

/* ========== YORUMLAR ========== */
const REVIEWS=[
  {n:'Seda K.',t:'1 günde kiralık; süreç şeffaf ve çok profesyoneldi.',s:5},
  {n:'Gökhan T.',t:'Doğru fiyat analiziyle 3 günde satış.',s:5},
  {n:'Mehmet A.',t:'Çayyolu bölgesinde rakipsiz, kesinlikle tavsiye ederim.',s:5},
  {n:'Ebru D.',t:'İlk görüşmeden tapuya kadar yanımızdaydı.',s:5},
  {n:'Nur S.',t:'Kiralama 48 saatte tamamlandı.',s:5},
  {n:'Tamer Y.',t:'İletişimi ve hızını çok beğendik.',s:5},
  {n:'Selin B.',t:'Yatırım için en doğru seçenekleri sundu.',s:4},
  {n:'Mert C.',t:'Fotoğraf ve ilan dili mükemmeldi.',s:5},
  {n:'Gizem K.',t:'Süreç boyunca her adım bilgi verildi.',s:5},
  {n:'Emre L.',t:'Bölgede ciddi portföy ağı var.',s:5},
  {n:'Damla P.',t:'Kısa sürede kaliteli kiracı bulundu.',s:5},
  {n:'Bora Z.',t:'Sonuç odaklı ve güven veriyor.',s:5}
];
function star(n){return '★★★★★'.slice(0,n)}
document.getElementById('twrap').innerHTML =
  REVIEWS.map(r=>`<div class="tcard"><div class="thead"><b>${r.n}</b><span class="src">Google</span></div><div class="stars">${star(r.s)}</div><div>${r.t}</div></div>`).join('');
</script>
</body>
</html>
